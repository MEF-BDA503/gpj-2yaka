---
title: "Group Proposal-2Yaka"
author: "Group 2Yaka"
date: "27 October 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Abstract


![](C:\Users\merye\Desktop\HR.jpg) 



The dataset we choose is about human resources. Our aim is to answer an interesting question by a company like "*Why are our best and most experienced employees leaving prematurely?*" We will try to find an answer to this question by analyzing answers of employees to specific questions about their conditions in work environment. The dataset is formed by the employer after surveying their employees.


# Group and Data Set Information

We named our group as *2Yaka*. 

Our group's members are:

* Meryem Kemerci
* Duygu Can
* Murat Donmez
* Cihan Tektunali

## Data Definition

Our data set is coming from the results of satisfaction surveys a company has applied to their employees. This data set consists of 14999 rows and 10 columns. Type of 8 columns is string, while other 2 columns are numeric such as;


**1.**Satisfaction Level 

**2.**Last evaluation 

**3.**Number of projects 

**4.**Average monthly hours 

**5.**Time spent at the company 

**6.**Whether they have had a work accident 

**7.**Whether they have had a promotion in the last 5 years 

**8.**Departments (column sales) 

**9.**Salary 

**10.**Whether the employee has left 


Our objective is to make predictions about the probabilities that employees may leave their company and what to change to increase their satisfaction levels. We will try to give insights to make best employees more loyal.

##Our tentative plan is as follows:

1. Explore the dimensions of variables
2. Clean the data if required
3. Summarise the data and search for correlations wherever possible
4. Visualize the filtered results
5. Make conclusions and give insights

## References

[Human Resources Analytics Data Set](https://www.kaggle.com/ludobenistant/hr-analytics/data)
```{r}
multiplot <- function(..., plotlist = NULL, file, cols = 1, layout = NULL) {
  require(grid)

  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  if (is.null(layout)) {
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                 ncol = cols, nrow = ceiling(numPlots/cols))
}

if (numPlots == 1) {
print(plots[[1]])

} else {
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

for (i in 1:numPlots) {
  matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

  print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                  layout.pos.col = matchidx$col))
 }
}
 }
```

## Preparation
We start by loading required libraries. 
```{r}
#getwd()


library('tidyverse')
library("dplyr")
library("ggplot2")

```
Then we read dataset from csv file and have a quick look at the data. 

# Read Data
```{r}
d=read.csv("HR_comma_sep.csv")
d<- d %>% rename("departments" = "sales")
glimpse(d)

```

As you can see we have nearly 15000 observations for job satisfaction, ...

```{r}
summary(d)
```

Having known all the column names and their related statistics, we wanted to visualize the distribution of the numerical ones, just the get better understanding for further interpretations. For this reason we employed histogram plots. Notice that bin size is chosen with respect to range of the data.

```{r}
p1 <- ggplot(subset(d ), aes(x=d$satisfaction_level, colour=d$satisfaction_level)) +
  geom_histogram(binwidth = 0.05,color = 'black', fill = '#099DD9') +
  ggtitle("Satisfaction Level")

p2 <- ggplot(subset(d ), aes(x=d$last_evaluation, colour=d$last_evaluation)) +
  geom_histogram(binwidth = 0.05,color = 'black', fill = '#FF8C00') +
  ggtitle("Last Evaluation")

p3 <- ggplot(subset(d ), aes(x=d$number_project, colour=d$number_project)) +
  geom_histogram(binwidth = 1,color = 'black', fill = '#9932CC') +
  ggtitle("Number Of Projects")

p4 <- ggplot(subset(d ), aes(x=d$average_montly_hours, colour=d$average_montly_hours)) +
  geom_histogram(binwidth = 10,color = 'black', fill = '#808000') +
  ggtitle("Average Monthly Hours")

p5 <- ggplot(subset(d ), aes(x=d$time_spend_company, colour=d$time_spend_company)) +
  geom_histogram(binwidth = 0.5,color = 'black', fill = '#9932CC') +
  ggtitle("Time Spend Company")

p6 <- ggplot(subset(d ), aes(x=d$Work_accident, colour=d$Work_accident)) +
  geom_histogram(binwidth = 0.8,color = 'black', fill = '#9932CC') +
  ggtitle("Work Accident")

p7 <- ggplot(subset(d ), aes(x=d$left, colour=d$left)) +
  geom_histogram(binwidth = 1,color = 'black', fill = '#2E8B57') +
  ggtitle("Left")


p8 <- ggplot(subset(d ), aes(x=d$promotion_last_5years, colour=d$promotion_last_5years)) +
  geom_histogram(binwidth = 0.8,color = 'black', fill = '#00BFFF') +
  ggtitle("Promotion (Last 5 Years)")


multiplot(p1,p2,p3,p4,p5,p6,p7,p8,cols=4)
```

According to above histograms, we found that; there was nearly no promoted employee in the last five years. Bear in mind that the work accident data belongs to last two years and frequency of accidents is low but not zero. Monthly time spent in the company and number of projects which each employee works on both have positively skewed distributions.

```{r}

# l <- list()
# 
# for (colNames in names(d)) { 
#    l <- ggplot(subset(d ), aes(x=d$colNames, colour=d$colNames)) +
#   geom_histogram(binwidth = 0.05,color = 'black', fill = '#099DD9') +
#   ggtitle(colNames)
#    
#     index = index +1
# }

```

```{r}
# for (i in names(d)) { 
#     print(ggplot(subset(d ), aes(x=d[i], colour=d$i)) +
#   geom_histogram(binwidth = 0.05,color = 'black', fill = '#9932CC') +
#   ggtitle("Last Evaluation") )
# }
```

Now, let's look at the categorical variables, salary and department name. We wanted to compare left and none-left employee counts by departments and salary categories. When salary category does not give much insight about the characteristics of left people, we found that the 3 departments have considerably higher number of people left. These departments are sales, technical and support.
```{r}

p9 <- ggplot(d, aes(x=d$departments,fill=as.character(d$left) ))
      +theme(axis.text.x = element_text(angle = 60, hjust=1))+
      geom_bar()

p10 <- ggplot(d, aes(x=d$salary,fill=as.character(d$left) ))+
      geom_bar()
#ggtitle("Average bill for 2 people")

multiplot(p9,p10,cols=2)


```


```{r}

 ggplot(data=d, aes(x=departments, y=satisfaction_level)) +
 geom_bar(stat="identity", position=position_dodge())

# ggplot(d, aes(x=salary, y=satisfaction_level)) +
#   geom_point(size=2, shape=23)
```
```{r}
department_left_rate<-d %>%
  group_by(departments) %>%
  summarise (n = n()) %>%
  mutate(freq = n / sum(n))

department_left_rate


ggplot(department_left_rate, aes(x=department_left_rate$departments,y=department_left_rate$freq ))+
      theme(axis.text.x = element_text(angle = 60, hjust=1))+
      geom_bar()

```

